import pandas as pd

def correlacao_variaveis(df):
    # Calcular a matriz de correlação
    matriz_correlacao = df.corr().stack().reset_index()
    
    # Renomear as colunas
    matriz_correlacao.columns = ['Variavel_correlacionada_1', 'Variavel_correlacionada_2', 'Correlacao']
    
    # Filtrar os resultados para excluir a correlação de uma variável consigo mesma (correlação igual a 1)
    matriz_correlacao = matriz_correlacao[matriz_correlacao['Correlacao'] != 1]
    
    # Remover as duplicatas, mantendo apenas uma combinação das variáveis correlacionadas
    matriz_correlacao = matriz_correlacao.loc[pd.DataFrame(np.sort(matriz_correlacao[['Variavel_correlacionada_1', 'Variavel_correlacionada_2']], axis=1)).duplicated(keep='first') == False]
    
    return matriz_correlacao

# Exemplo de uso da função
dados = {
    'A': [1, 2, 3, 4, 5],
    'B': [2, 3, 4, 5, 6],
    'C': [5, 4, 3, 2, 1],
    'D': [1, 3, 5, 7, 9],
}

df = pd.DataFrame(dados)

resultado = correlacao_variaveis(df)
print(resultado)
