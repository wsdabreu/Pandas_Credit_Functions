import pandas as pd
import numpy as np

def correlacao_variaveis(df):
    # Calcular a matriz de correlação
    matriz_correlacao = df.corr().stack().reset_index()
    
    # Renomear as colunas
    matriz_correlacao.columns = ['Variavel_correlacionada_1', 'Variavel_correlacionada_2', 'Correlacao']
    
    # Filtrar os resultados para excluir a correlação de uma variável consigo mesma (correlação igual a 1)
    matriz_correlacao = matriz_correlacao[matriz_correlacao['Correlacao'] != 1]
    
    # Remover as duplicatas, mantendo apenas uma combinação das variáveis correlacionadas
    matriz_correlacao['sorted_columns'] = matriz_correlacao.apply(lambda x: sorted([x['Variavel_correlacionada_1'], x['Variavel_correlacionada_2']]), axis=1)
    matriz_correlacao['duplicates'] = matriz_correlacao['sorted_columns'].duplicated(keep='first')
    matriz_correlacao = matriz_correlacao[matriz_correlacao['duplicates'] == False].drop(columns=['sorted_columns', 'duplicates'])
    
    return matriz_correlacao

# Exemplo de uso da função
dados = {
    'A': [1, 2, 3, 4, 5],
    'B': [2, 3, 4, 5, 6],
    'C': [5, 4, 3, 2, 1],
    'D': [1, 3, 5, 7, 9],
}

df = pd.DataFrame(dados)

resultado = correlacao_variaveis(df)
print(resultado)
